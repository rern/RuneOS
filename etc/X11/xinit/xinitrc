#!/bin/bash

export XDG_CACHE_HOME="/tmp/.cache"
export DISPLAY=:0

sec=$( cat /srv/http/data/system/screenoff 2> /dev/null || echo 0 )
xset dpms $sec $sec $sec
if (( $sec == 0 )); then
	xset s off
	xset -dpms
fi

if [[ ! -e /srv/http/data/system/cursor ]] && ifconfig | grep -A1 'eth0\|wlan0' | grep -q inet; then
	cursor=no
else 
	cursor=yes
fi
matchbox-window-manager -use_cursor $cursor &

zoom=$( cat /srv/http/data/system/zoom 2> /dev/null || echo 1 )
chromium --app=http://localhost --kiosk --incognito --no-sandbox --force-device-scale-factor=$zoom
